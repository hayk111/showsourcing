<!-- Here is a stackblitz with a smaller version of the tables to understand it more easily

https://stackblitz.com/edit/angular-vtluff?file=src/app/app.component.ts -->

<div
	class="ctnr will-change-scroll"
	[ngClass]="{ 'with-border': hasBorder, 'with-pagination': hasPagination }">

	<div class="contentCtnr">

		<!-- empty column for space between border bottom and side -->
		<div *ngIf="hasHeader" class="col empty-border no-grows">
			<div
				class="header"
				[style.height]="rowHeight + 'px'">
			</div>
			<div
				*ngFor="let row of rows; index as i; trackBy: trackByIdentify"
				class="cell"
				[ngClass]="{ selected: isSelected(row, i) }"
				[style.height]="rowHeight + 'px'">
			</div>
		</div>

		<!-- selection column -->
		<div
			*ngIf="hasSelection"
			class="col selectionCol no-grows"
			[style.height]="rowHeight + 'px'">
			<div
				*ngIf="hasHeader"
				class="header"
				[style.height]="rowHeight + 'px'">
				<select-checkbox-app
					[state]="getSelectionState()"
					(check)="onSelectAll(rows)"
					(uncheck)="onUnselectAll()">
				</select-checkbox-app>
			</div>
			<ng-container *ngIf="!pending">
				<div
					*ngFor="let row of rows; index as i; trackBy: trackByIdentify"
					class="cell"
					[ngClass]="{ selected: isSelected(row, i) }"
					[style.height]="rowHeight + 'px'">
					<checkbox-app
						*ngIf="isSelectable(row)"
						[value]="selected.has(row[idName])"
						(check)="onSelectOne(row)"
						(uncheck)="onUnselectOne(row)">
					</checkbox-app>
				</div>
			</ng-container>
		</div>


		<!-- content columns -->
		<div *ngFor="let column of columns; let i = index; trackBy: columnTrackByFn()"
			class="col {{ column.grows ? 'grows' : '' }}"
			[ngClass]="{'primary-col': listView && i == 0}"
			[style.width]="column.width + 'px'">
			<!-- header -->
			<div *ngIf="hasHeader"
				class="header {{ column.sortable ? 'pointer' : 'defaultCursor'}} capitalize"
				[class.sorted]="sortSrv.isSorted(column.sortBy)"
				[style.height]="rowHeight + 'px'"
				(click)="sortSrv.toggleSort(column.sortBy)">
				{{ column.title }}
				<ng-container *ngIf="sortSrv.isSorted(column.sortBy)">
					<icon-app
						class="sortIcon fs-xs"
						[name]="(sortSrv.sort$ | async).direction === 'DESC' ? 'angle-down' : 'angle-up'">
					</icon-app>
				</ng-container>
			</div>

			<!-- cells -->
			<ng-container *ngIf="!pending">
				<div
					*ngFor="let row of rows; index as i; trackBy: cellTrackByFn(column.type)"
					class="cell"
					[class.selected]="isSelected(row, i)"
					[ngClass]="'cell--' + i"
					[style.height]="rowHeight + 'px'">
					<!-- Render the column template when specified -->
					<ng-container *ngIf="!column.showOnHover || i === hoverIndex">
						<ng-container
							*ngTemplateOutlet="column.template; context: { column: column, row: row, index: i }">
						</ng-container>
						<!-- {{getRowDisplayCount()}} -->
						<!-- <icon-app name="eye"></icon-app> -->
					</ng-container>
				</div>
			</ng-container>

		</div>

		<!-- contextual menu -->
		<div *ngIf="hasMenu" class="col no-grows">
			<div
				*ngIf="hasHeader"
				class="header"
				[style.height]="rowHeight + 'px'"
				[style.minWidth]="'50px'">
			</div>
			<ng-container *ngIf="!pending">
				<div
					*ngFor="let row of rows; index as i; trackBy: trackByIdentify"
					class="menuCell cell flexCenter"
					[ngClass]="{ selected: isSelected(row, i) }"
					[style.height]="rowHeight + 'px'">
					<context-menu-app
						*ngIf="isSelectable(row)"
						[ngClass]="{ hover: (i === hoverIndex) }"
						[ngStyle]="{ visibility: ((i === hoverIndex) || isSelected(row, i)) ? 'visible' : 'hidden' }"
						[closeOnScroll]="true">
						<context-menu-trigger-app>
							<icon-app
								class="color-third"
								name="dots-vertical"
								size="18">
							</icon-app>
						</context-menu-trigger-app>
						<ng-container
							*ngTemplateOutlet="contextualMenu; context: { row: row }">
						</ng-container>
					</context-menu-app>
				</div>
			</ng-container>
		</div>

		<!-- pending -->
		<div *ngIf="pending" class="pendingCtnr flexCenter">
			<dots-app></dots-app>
		</div>

	</div>


	<div
		*ngIf="rows?.length === 0 && !pending"
	 	class="flexCenter flexColumn placeholderCtnr"
		[class.mg-top-l]="hasHeader"
		[class.mg-bottom-l]="hasHeader">
		<logo-app
			class="placeholder-logo"
			[circle]="true"
			size="xxl"
			[typename]="typename">
		</logo-app>
		<ng-container *ngIf="!isSeaching; else placeholderSearch">
			<div class="placeholder-title" translate="OBJ.no-type-found" [translateParams]="{ type: typename }"></div>
			<div class="placeholder-description" translate="text.create-new-one"></div>
			<button class="capitalize" (click)="createClick.emit()">{{ createEntityBtnName || ('OBJ.create' | translate: { field: (typename) }) }}</button>
		</ng-container>
		<ng-template #placeholderSearch>
			<div *ngIf="isSeaching" class="placeholder-title" translate="OBJ.no-OBJ-matches-criteria" [translateParams]="{ type: typename }"></div>
		</ng-template>
	</div>


</div>

<pagination-app
	*ngIf="hasPagination && !pending"
	[hasSidePadding]="hasPaddingPagination"
	[hasPageItemsCount]="hasShowItemsPerPage">
</pagination-app>
