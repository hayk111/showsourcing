<div *ngIf="!editMode">
  <div class="flex editable" [class.flexBetween]="!isRightAligned && !isCompactInline" [class.isCompactInline]="isCompactInline" [class.rightAligned]="isRightAligned">
    <div class="editButton leftButton" *ngIf="isRightAligned" (click)="openEditMode()">Edit </div>
    <!-- if we get an id as value, we should display the name of the entity -->
		<!-- else we just display said value -->
    <ng-container [ngSwitch]="true">

			<!-- entities -->
      <ng-container *ngSwitchCase="['suppliers', 'events', 'categories', 'productStatus', 'harbours', 'incoTerms'].indexOf(type) > -1">
        <span>
          {{ value | entityName: type | async }}
        </span>
			</ng-container>

			<!-- price -->
      <ng-container *ngSwitchCase="type === 'price'">
        <span>
          {{ value }}
        </span>
        <span class="currencyTag" *ngIf="entity?.priceCurrency">
          {{ entity?.priceCurrency?.symbol || entity?.priceCurrency?.id }}
        </span>
			</ng-container>

			<!-- user -->
      <ng-container *ngSwitchCase="type === 'teamMembers'">
        <span class="userOpt">
          <user-picture-app [size]="24" [border]="false" [url]="(value | entity: 'teamMembers' | async).preferences.profilePicture.urls.url_60x45"></user-picture-app>
          {{ value | entityName: 'teamMembers' | async }}
        </span>
			</ng-container>

			<!-- tags -->
      <ng-container *ngSwitchCase="['tags', 'projects'].indexOf(type) > -1">
        <span class="tags">
          <span class="tag" *ngFor="let tagid of value">
            {{ tagid | entityName: type | async }}
          </span>
        </span>
			</ng-container>

			<!-- currency -->
      <ng-container *ngSwitchCase="type === 'currencies'">
        <span>
					{{ value?.name }}
        </span>
			</ng-container>

			<!-- default -->
      <ng-container *ngSwitchDefault>
        <span class="flex valueContent">
          {{ value || '-'}}
        </span>
      </ng-container>
		</ng-container>

    <div class="editButton pointer" *ngIf="!isRightAligned" (click)="openEditMode()">Edit </div>
  </div>
</div>

<!-- when edit mode is on -->
<div class="flexRow" *ngIf="editMode" (clickOutside)="closeEditMode()">
	<ng-container [ngSwitch]="true">

		<!-- default text  -->
		<ng-container *ngSwitchDefault>
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<input inputApp type="text" (change)="updateValue($event.target.value)"/>
			</form-field-app>
		</ng-container>

		<!-- price -->
		<ng-container *ngSwitchCase="type === 'price' || type === 'number'">
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<input inputApp type="number" (change)="updateValue(+$event.target.value)"/>
			</form-field-app>
		</ng-container>

		<!-- Textarea editor -->
		<ng-container *ngSwitchCase="type === 'textarea'">
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<textarea inputApp (change)="updateValue($event.target.value)">{{ value }}</textarea>
			</form-field-app>
		</ng-container>


		<!-- Entity selector -->
		<ng-container *ngSwitchCase="['suppliers', 'categories', 'events', 'incoTerms', 'harbours'].indexOf(type) > -1">
			<ng-select #entitySelector class="entitySelector" [virtualScroll]="true" [items]="type | entityList | async" bindLabel="name"
				bindValue="id" (change)="update.emit($event?.id)" [ngModel]="value">
				<ng-template ng-header-tmp>
					<div class="selectCustomInput">
						<input style="width: 100%" type="text" (input)="entitySelector.filter($event.target.value)" />
					</div>
				</ng-template>
			</ng-select>
		</ng-container>

		<!-- currency selector -->
		<ng-container *ngSwitchCase="type === 'currencies'">
			<ng-select #currenciesSelector class="entitySelector" [virtualScroll]="true"
				[items]="'currencies' | entityList | async" bindLabel="name"
				bindValue="id" (change)="update.emit($event)" [ngModel]="value.id">
				<ng-template ng-header-tmp>
					<div class="selectCustomInput">
						<input style="width: 100%" type="text" (input)="currenciesSelector.filter($event.target.value)" />
					</div>
				</ng-template>
			</ng-select>
		</ng-container>

		<!-- Tags selector -->
		<ng-container *ngSwitchCase="type === 'tags'">
			<ng-select #tagsSelector class="entitySelector" [virtualScroll]="true" multiple="true" [items]="'tags' | entityList | async" bindLabel="name"
				bindValue="id" (change)="updateTags($event)" [ngModel]="value" [addTag]="addTagCallback">
				<ng-template ng-header-tmp>
					<div class="selectCustomInput">
						<input #tagSearch style="width: 100%" type="text" (input)="tagsSelector.filter($event.target.value)" />
					</div>
				</ng-template>
			</ng-select>
		</ng-container>


		<!-- Project selector -->
		<ng-container *ngSwitchCase="type === 'projects'">
			<ng-select #projectsSelector class="entitySelector" [virtualScroll]="true" multiple="true" [items]="'projects' | entityList | async" bindLabel="name"
				bindValue="id" (change)="updateProjects($event)" [ngModel]="value" [addTag]="addProjectCallback">
				<ng-template ng-header-tmp>
					<div class="selectCustomInput">
						<input style="width: 100%" type="text" (input)="projectsSelector.filter($event.target.value)" />
					</div>
				</ng-template>
			</ng-select>
		</ng-container>


		<!-- User selector -->
		<ng-container *ngSwitchCase="type === 'teamMembers'">
			<ng-select #userSelector class="entitySelector" [virtualScroll]="true" [items]="'teamMembers' | entityList | async" bindLabel="name" bindValue="id"
				(change)="update.emit($event?.id)" [ngModel]="value">
				<ng-template ng-header-tmp>
					<div class="selectCustomInput">
						<input style="width: 100%" type="text" (input)="userSelector.filter($event.target.value)" />
					</div>
				</ng-template>
				<ng-template ng-label-tmp let-item="item">
					<span class="userOpt">
						<user-picture-app [size]="24" [border]="false" [url]="item?.preferences?.profilePicture?.urls?.url_60x45"></user-picture-app>
						{{item.name}}
					</span>
				</ng-template>
				<ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
					<span class="userOpt">
						<user-picture-app [size]="24" [border]="false" [url]="item?.preferences?.profilePicture?.urls?.url_60x45"></user-picture-app>
						{{item.name}}
					</span>
				</ng-template>
			</ng-select>
		</ng-container>

		<!-- Status selector -->
		<ng-container *ngSwitchCase="type === 'productStatus'">
			<ng-select #statusSelector class="entitySelector" [virtualScroll]="true" [items]="'productStatus' | entityList | async"
				bindLabel="name" bindValue="id"
				(change)="update.emit($event?.id)" [ngModel]="value">
				<ng-template ng-header-tmp>
					<div class="selectCustomInput">
						<input style="width: 100%" type="text" (input)="statusSelector.filter($event.target.value)" />
					</div>
				</ng-template>
				<ng-template ng-label-tmp let-item="item">
					<span class="userOpt">
						<user-picture-app [size]="24" [border]="false" [url]="item?.preferences?.profilePicture?.urls?.url_60x45"></user-picture-app>
						{{item.name}}
					</span>
				</ng-template>
				<ng-template ng-option-tmp let-item="item" let-index="index" let-search="searchTerm">
					<span class="userOpt">
						<user-picture-app [size]="24" [border]="false" [url]="item?.preferences?.profilePicture?.urls?.url_60x45"></user-picture-app>
						{{item.name}}
					</span>
				</ng-template>
			</ng-select>
		</ng-container>

	</ng-container>


  <div class="confirmBlock" *ngIf="['suppliers', 'categories','events', 'tags', 'projects', 'productStatus', 'currencies', 'harbours','incoTerms'].indexOf(type) === -1">
		<span class="confirmIcon icon-close" fs-s color-white bg-txt-secondary (click)="closeEditMode()"></span>
		<span class="confirmIcon icon-thumb-up" fs-s color-white bg-primary (click)="onSave()"></span>
  </div>

</div>
