<div *ngIf="!editMode" class="{{ editable ? 'pointer': '' }}" (click)="openEditMode()">
  <div class="flex editable" [class.flexBetween]="!isRightAligned && !isCompactInline" [class.isCompactInline]="isCompactInline" [class.rightAligned]="isRightAligned">
		<div class="editButton leftButton" *ngIf="isRightAligned && editable" (click)="openEditMode()">Edit </div>

		<ng-container *ngIf="!value">
			-
		</ng-container>
    <!-- if we get an id as value, we should display the name of the entity -->
		<!-- else we just display said value -->
    <ng-container [ngSwitch]="true" *ngIf="value">

			<!-- entities -->
      <ng-container *ngSwitchCase="['supplier', 'event', 'category', 'productStatus', 'harbour', 'incoTerm'].indexOf(type) > -1">
        <span>
          {{ value | entityName: type | async }}
        </span>
			</ng-container>

			<!-- country -->
      <ng-container *ngSwitchCase="type === 'country'">
        <span>
          {{ value | entity: 'country': 'fullName' | async }}
        </span>
			</ng-container>

			<!-- price -->
      <ng-container *ngSwitchCase="type === 'price'">
        <span>
          {{ value }}
        </span>
        <span class="currencyTag" *ngIf="entity?.priceCurrency">
          {{ entity?.priceCurrency?.symbol || entity?.priceCurrency?.id }}
        </span>
			</ng-container>

			<!-- user -->
      <ng-container *ngSwitchCase="type === 'teamMember'">
        <span class="userOpt">
					<user-picture-app [size]="24" [border]="false"
						[url]="(value | entity: 'teamMember' | async)?.preferences?.profilePicture?.urls?.url_60x45">
					</user-picture-app>
          {{ value | entityName: 'teamMember' | async }}
        </span>
			</ng-container>

			<!-- tags, projects -->
      <ng-container *ngSwitchCase="['tag', 'project'].indexOf(type) > -1">
        <span class="tags" *ngIf="value.length > 0">
          <span class="tag" *ngFor="let itemId of value">
            {{ itemId | entityName: type | async }}
          </span>
				</span>
				<span *ngIf="value.length === 0">-</span>
			</ng-container>

			<!-- categories -->
			<ng-container *ngSwitchCase="type === 'categories'">
				<span class="tags" *ngIf="value.length > 0">
					<span class="tag" *ngFor="let itemId of value">
						{{ itemId | entityName: 'category' | async }}
					</span>
				</span>
				<span *ngIf="value.length === 0">-</span>
			</ng-container>

			<!-- currency -->
      <ng-container *ngSwitchCase="type === 'currency'">
        <span>
					{{ value?.name }}
        </span>
			</ng-container>

			<!-- default -->
      <ng-container *ngSwitchDefault>
        <span class="flex valueContent">
          {{ value }}
        </span>
      </ng-container>
		</ng-container>

    <div class="editButton pointer" *ngIf="!isRightAligned && editable">Edit </div>
  </div>
</div>

<!-- when edit mode is on -->
<div class="flex" *ngIf="editMode" (clickOutside)="onSave()">
	<ng-container [ngSwitch]="true">

		<!-- default text  -->
		<ng-container *ngSwitchDefault>
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<input inputApp
				(keyup.enter)="onSave()"
				[value]="value || ''" [type]="type"
				(input)="updateValue($event.target.value)"/>
			</form-field-app>
		</ng-container>

		<!-- number -->
		<ng-container *ngSwitchCase="type === 'number'">
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<input inputApp
					(keyup.enter)="onSave()"
					restrictInput="number"
					[value]="value || ''"
					type="number"
					(input)="updateValue(+$event.target.value)"/>
			</form-field-app>
		</ng-container>

		<!-- email -->
		<ng-container *ngSwitchCase="type === 'email'">
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<input inputApp
					(keyup.enter)="onSave()"
					[value]="value || ''"
					type="email"
					(input)="updateValue($event.target.value)"
					email/>
			</form-field-app>
		</ng-container>

		<!-- tel  -->
		<ng-container *ngSwitchCase="type === 'tel'">
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<input inputApp
				(keyup.enter)="onSave()"
				restrictInput="tel"
				[value]="value || ''"
				type="text"
				(input)="updateValue($event.target.value)"/>
			</form-field-app>
		</ng-container>

		<!-- price -->
		<ng-container *ngSwitchCase="type === 'price'">
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<input inputApp
				(keyup.enter)="onSave()"
				restrictInput="decimal"
				[value]="value || ''"
				type="number"
				(input)="updateValue(+$event.target.value)"/>
			</form-field-app>
		</ng-container>

		<!-- Textarea editor -->
		<ng-container *ngSwitchCase="type === 'textarea'">
			<form-field-app>
				<label-app>{{ label }}</label-app>
				<textarea inputApp
				(keyup.enter)="onSave()"
				(change)="updateValue($event.target.value)">{{ value }}</textarea>
			</form-field-app>
		</ng-container>


		<!-- Entity selector -->
		<ng-container *ngSwitchCase="['supplier', 'category', 'event', 'incoTerm', 'harbour', 'teamMember'].indexOf(type) > -1">
			<selector-app
				[value]="value"
				[choices]="type | entityList | async"
				[itemName]="getSingular(type)"
				(select)="updateValue($event?.id); onSave()"
				[canSearch]="true">
				<ng-template let-item="item">
					{{ item.name }}
				</ng-template>
			</selector-app>
		</ng-container>

		<!-- Entity selector -->
		<ng-container *ngSwitchCase="type === 'country'">
			<selector-app
				[value]="value"
				[choices]="'country' | entityList | async"
				[itemName]="getSingular(type)"
				(select)="updateValue($event?.id);onSave()"
				[canSearch]="true"
				propName="fullName">
				<ng-template let-item="item">
					{{ item.fullName }}
				</ng-template>
			</selector-app>
		</ng-container>

		<!-- currency selector -->
		<ng-container *ngSwitchCase="type === 'currency'">
			<!-- different than other selectors because of value and returned values -->
			<selector-app [choices]="'currency' | entityList | async"
				[itemName]="'currency'"
				[value]="value?.id"
				(select)="updateValue($event);onSave()"
				[canSearch]="true">
				<ng-template let-item="item">
					{{ item.name }}
				</ng-template>
			</selector-app>
		</ng-container>

		<!-- Tags selector -->
		<ng-container *ngSwitchCase="type === 'tag'">
			<selector-app
				[choices]="'tag' | entityList | async"
				[multiple]="true"
				[value]="value"
				(select)="itemAdded.emit({ type: 'tag', value: $event })"
				(unselect)="itemRemoved.emit({ type: 'tag', value: $event })"
				(create)="itemCreate.emit({ type: 'tag', value: $event })"
				[canSearch]="true"
				[canCreate]="true">
				<ng-template let-item="item">
					{{ item.name }}
				</ng-template>
			</selector-app>
		</ng-container>

		<!-- Project selector -->
		<ng-container *ngSwitchCase="type === 'project'">
				<selector-app
					[choices]="'project' | entityList | async"
					[multiple]="true"
					[value]="value"
					(select)="itemAdded.emit({ type: 'project', value: $event })"
					(unselect)="itemRemoved.emit({ type: 'project', value: $event })"
					(create)="itemCreate.emit({ type: 'project', value: $event })"
					[canSearch]="true"
					[canCreate]="true">
					<ng-template let-item="item">
						{{ item.name }}
					</ng-template>
				</selector-app>
			</ng-container>

			<!-- categories selector -->
			<ng-container *ngSwitchCase="type === 'categories'">
					<selector-app
						[choices]="'category' | entityList | async"
						[multiple]="true"
						[value]="value"
						(select)="itemAdded.emit({ type: 'category', value: $event })"
						(unselect)="itemRemoved.emit({ type: 'category', value: $event })"
						(create)="itemCreate.emit({ type: 'category', value: $event })"
						[canSearch]="true"
						[canCreate]="true">
						<ng-template let-item="item">
							{{ item.name }}
						</ng-template>
					</selector-app>
				</ng-container>


		<!-- Status selector -->
		<ng-container *ngSwitchCase="type === 'productStatus'">
			<selector-app
				[choices]="'productStatus' | entityList | async"
				[value]="value?.id"
				[canSearch]="false"
				(select)="updateValue($event?.id);onSave()">
				<ng-template let-item="item">
					<badge-app color="{{ item.id }}">{{ item.name }}</badge-app>
				</ng-template>
			</selector-app>
		</ng-container>

	</ng-container>


  <div class="confirmBlock" *ngIf="['text', 'number', 'textarea', 'price', 'decimal', 'url', 'tel', 'email', 'dimensions'].indexOf(type) > -1">
		<span class="confirmIcon icon-close fs-s color-white bg-txt-secondary" (click)="closeEditMode()"></span>
		<span class="confirmIcon icon-thumb-up fs-s color-white bg-primary" (click)="onSave()"></span>
  </div>

</div>
