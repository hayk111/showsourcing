<table-app
	type="supplier"
	[placeholder]="'placeholder.no-supplier' | translate"
	[rows]="rows"
  [currentSort]="currentSort"
  [pending]="pending"
	[isSeaching]="isFiltering"
  [count]="count"
  [currentPage]="currentPage"
	[selected]="selection"
	[hasMenu]="hasMenu"
  [hasHeader]="hasHeader"
	[hasPagination]="hasPagination"
	[hasSelection]="hasSelection"
	[hasBorder]="hasBorder"
  [contextualMenu]="contextualMenuTemplate"
  (goToPage)="goToPage.emit($event)"
  (bottomReached)="bottomReached.emit()"
  (sort)="sort.emit($event)"
  (selectOne)="select.emit($event)"
  (unselectOne)="unselect.emit($event)"
  (selectAll)="selectAll.emit($event)"
	(unselectAll)="unselectAll.emit()"
	(createClick)="createClick.emit()"
	(showItemsPerPage)="showItemsPerPage.emit($event)"
	(hovered)="hovered = $event">

	<!-- dynamic columns -->
	<ng-template
		*ngFor="let column of columnsConfig; trackBy: trackByFn"
		let-row="row"
		[columnApp]="column.translationKey ? ('title.' + column.translationKey | translate) : ''"
		[sortable]="column.sortable !== false"
		[width]="column.width"
		[sortBy]="column.sortProperty"
		[grows]="!column.fixedWidth">

		<ng-container [ngSwitch]="column.name">

			<default-columns-app
				*ngSwitchDefault
				[row]="row"
				[column]="column"
				[hovered]="row.id === hovered"
				[type]="'SUPPLIER' | erm"
				(update)="update.emit($event)"
				(previewClick)="previewClick.emit($event)"
				(nameClick)="open.emit($event)"
				(previewClick)="previewClick.emit($event)"
				(logoClick)="previewClick.emit($event)">
			</default-columns-app>

			<!-- logo -->
			<ng-container *ngSwitchCase="'logo'">
				<logo-app
					class="pointer"
					size="s"
					[logo]="row?.logoImage"
					[type]="'SUPPLIER' | erm: 'singular'"
					(click)="previewClick.emit(row)">
				</logo-app>
			</ng-container>

			<!-- categories -->
			<ng-container *ngSwitchCase="'categories'">

				<editable-container-app
					class="full-width"
					[hasAction]="false"
					[openOnClick]="false"
					(click)="sel.openMenu()">
					<editable-display-app>
						<selector-app
							#sel
							[type]="'CATEGORY' | erm: 'singular'"
							[offsetX]="4"
							[value]="row?.categories"
							[multiple]="true"
							[canCreate]="true"
							[width]="320"
							(update)="update.emit({ id: row?.id, categories: $event })">
							<div class="pointer" >
								<span
									*ngFor="let cat of row.categories; let last = last; trackBy: trackByFn">
									{{ cat?.name }}{{ last ? '' : ',&nbsp;'}}
								</span>
								<span *ngIf="!row?.categories?.length">-</span>
							</div>
						</selector-app>
					</editable-display-app>
				</editable-container-app>

			</ng-container>

			<!-- country -->
			<ng-container *ngSwitchCase="'country'">
				<editable-container-app
					class="full-width"
					[hasAction]="false"
					[openOnClick]="false"
					(click)="sel.openMenu()">
					<editable-display-app>
						<selector-app
							#sel
							[type]="'COUNTRY' | erm: 'singular'"
							[offsetX]="4"
							[width]="320"
							(update)="update.emit({ id: row?.id, country: $event })">
							<span>
								{{ row?.country ? (row?.country | const: 'country') : '-' }}
							</span>
						</selector-app>
					</editable-display-app>
				</editable-container-app>
			</ng-container>

			<!-- type -->
			<ng-container *ngSwitchCase="'type'">
				<selector-app
					[type]="'SUPPLIER_TYPE' | erm: 'singular'"
					[width]="320"
					[offsetX]="4"
					(update)="update.emit({ id: row?.id, supplierType: $event })">
					<div class="pointer txt-btn">
						{{ row?.supplierType?.name || '-' }}
					</div>
				</selector-app>
			</ng-container>

		</ng-container>
	</ng-template>

</table-app>



<!-- contextual menu -->
<ng-template #contextualMenuTemplate let-row="row">
	<context-menu-item-app
		(click)="archive.emit(row)"
		translate="button.archive">
		<div class="icon-box square flexCenter mg-right-s">
			<icon-app name="archive" size="s"></icon-app>
		</div>
		<span translate="button.archive"></span>
	</context-menu-item-app>
	<context-menu-item-warn-app
		(click)="delete.emit(row)">
		<div class="icon-box square flexCenter mg-right-s">
			<icon-app name="delete" size="s"></icon-app>
		</div>
		<span translate="button.delete"></span>
	</context-menu-item-warn-app>
</ng-template>
