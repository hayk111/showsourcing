<dialog-app>
  <dialog-header-app>
		<div class="flex">
			<div class="flex move">
				<icon-app name="arrow-left-thin" (click)="back()"></icon-app>
				<span class="spacer"></span>
				<icon-app name="arrow-right-thin" (click)="next()"></icon-app>
			</div>

			<div class="title">
				<h2>{{ element?.name }}</h2>
				<span class="color-primary fs-m">{{ selectedIndex + 1 }} / {{ elements.length }} Products</span>
			</div>
		</div>
	</dialog-header-app>

	<div class="info-banner flexCenter">This is the reply from your supplier</div>

  <ng-container *ngIf="element">
    <ng-container *ngIf="element?.reply as reply">

      <article>
        <h3 class="ms">Product Details</h3>

        <list-app>
					<comparison-row-app class="title-row" label="" [values]="['Current Values', 'Supplier\'s Answer']" [hasCheckbox]="false"></comparison-row-app>
          <list-item-app *ngFor="let field of element.reply.fields; trackBy: trackByFn">
						<comparison-row-app
							[checked]="selectionFields.has(field.id)"
							[label]="field?.definition?.label"
							[values]="getValues( field )"
							(selected)="selectItem(field)"
							(unselected)="unselectItem(field)">
						</comparison-row-app>
          </list-item-app>
        </list-app>

        <footer class="flex">
          <button class="primary accept" (click)="acceptAllFields()">Accept All</button>
          <button class="secondary" (click)="refuseAllFields()">Refuse All</button>
        </footer>
      </article>

      <article *ngIf="reply?.images?.length > 0">
        <h3 class="l">Additional Pictures</h3>

        <!-- I don't think image previewer can be used because of the overlay, or alternatively we have to pass something to the previewer to see an overlay
				as ng-content -->
				<image-reviewer-app
					[images]="reply?.images"
					[selection]="selectionImages"
					(selected)="selectionImages.set($event.id, $event)"
					(unselected)="selectionImages.delete($event.id)">
				</image-reviewer-app>

        <footer class="flex">
          <button class="primary accept" (click)="acceptAllImages()">Accept All</button>
          <button class="secondary" (click)="refuseAllImages()">Refuse All</button>
        </footer>
      </article>


      <article *ngIf="reply?.attachments?.length > 0">
        <h3>Additional Attachments</h3>

        <file-list-app [static]="true" [hasPlaceholder]="false" [files]="reply?.attachments"></file-list-app>

        <footer class="flex">
          <button class="primary accept">Accept All</button>
          <button class="secondary">Refuse All</button>
        </footer>
      </article>

    </ng-container>
	</ng-container>

	<dialog-footer-app>
		<button class="secondary">Close Request</button>
		<button class="secondary">Send back</button>
		<button (click)="acceptRequest()">Accept Request</button>
	</dialog-footer-app>

</dialog-app>