<div class="header flex">
	<!-- div added for the cell without border -->
	<div class="spacer mg-s"></div>
	<div class="flex flexGrow">
		<div class="w-5"></div>
		<div class="w-5 capitalize" i18n="@@step">step</div>
		<div class="w-40 capitalize" i18n="@@name">name</div>
		<div class="w-20 capitalize" i18n="@@cateogry">category</div>
		<div class="w-20 capitalize" i18n="@@final-step">Final step</div>
		<div class="w-10"></div>
	</div>

</div>

<div class="list" cdkDropList (cdkDropListDropped)="onDrop($event)">
	<div class="box" *ngFor="let status of statuses; let last = last" cdkDrag [cdkDragDisabled]="status?.step === 0" >
		<!-- placeholder -->
		<div class="bg-primary custom-placeholder" *cdkDragPlaceholder></div>
		<!-- no border -->
		<div class="spacer mg-s"></div>

		<div class="flex flexGrow sub-cell" [ngClass]="{ 'with-border': !last }">
			<!-- handle -->
			<div class="w-5 cell">
				<icon-app *ngIf="status?.step !== 0" cdkDragHandle class="handle" name="grip-vertical" fontSet="fa"></icon-app>
			</div>
			<!-- step -->
			<div class="w-5 cell">{{ status?.step }}</div>
			<!-- name -->
			<div class="w-40 cell">
				<editable-text-app
					class="pointer"
					#editable
					[openOnClick]="status?.step !== 0"
					(opened)="inp.focus()" (closed)="onEditableClose($event, inp.value, status)">
					<editable-label-app [ngClass]="{ 'no-hover': status.step == 0 }">
						{{ status.name | const: 'statuses' }}
						<button *ngIf="status?.step !== 0" class="ugly-btn" i18n="@@rename">rename</button>
					</editable-label-app>
					<input #inp inputApp type="text" [value]="status?.name" (keyup.enter)="editable.close()"/>
				</editable-text-app>
			</div>
			<!-- category -->
			<div class="w-20 cell">
				<context-menu-app *ngIf="status.step !== 0; else zeroStep">
					<context-menu-trigger-app>
						<div class="flexBetween badge" [ngClass]="getType(status)">
							<div class="flexCenter fullWidth">	{{ status?.category | const: 'statusCategory'}}	</div>
							<div> <icon-app name="caret-down"></icon-app> </div>
						</div>
					</context-menu-trigger-app>
					<context-menu-item-app *ngFor="let category of categories" (click)="update.emit([{ id: status.id, category: category.name }])">
						{{ category?.name | const: 'statusCategory' }}
					</context-menu-item-app>
				</context-menu-app>
				<ng-template #zeroStep>
					<div class="flexCenter badge" [ngClass]="getType(status)">
						{{ status?.category | const: 'statusCategory'}}
					</div>
				</ng-template>
			</div>
			<!-- final -->
			<div class="w-20 cell">
				<!-- when model is changed -->
				<!-- <checkbox-app *ngIf="status.step !== 0" [checked]="status.final"></checkbox-app> -->
				<checkbox-app *ngIf="status.step !== 0"></checkbox-app>
			</div>
			<!-- preview -->
			<div class="w-10 cell">
				<button *ngIf="status.step !== 0" class="ugly-btn capitalize" (click)="delete.emit(status.id)" i18n="@@delete-status">Delete status</button>
			</div>
		</div>
	</div>
</div>