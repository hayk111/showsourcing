<card-app>
	<div *ngIf="(listSrv.items$ | async)?.length; else empty" class="container">
		<div class="title">
			<span class="capitalize" i18n="header@@products">products</span>
			<button class="secondary" (click)="viewAll()" i18n="button@@view-all-products">
				View All Products
			</button>
		</div>
		<div class="products-section">
			<ng-container *ngFor="let product of listSrv.items$ | async; index as i; trackBy: trackById">
				<!-- only the last item has a margin bottom, and if its the final row, no margin-bottom -->
				<product-grid-card-app
					*ngIf="i < maxItemsDisplay"
					[ngClass]="{'no-left-margin': i % 3 == 0, 'margin-bottom-card': (i !== maxItemsDisplay - 1) && (i % 3 == 2)}"
					[hasCheckbox]="false"
					[product]="product"
					[selected]="(listSrv.selection$ | async)?.has(product?.id)"
					(favorited)="listSrv.onItemFavorited(product?.id)"
					(unfavorited)="listSrv.onItemUnfavorited(product?.id)"
					(liked)="listSrv.onThumbUp(product)"
					(disliked)="listSrv.onThumbDown(product)"
					(open)="listSrv.goToDetails(product.id)"
					(preview)="listSrv.openPreview(product)"
					(select)="listSrv.selectOne(product, true)"
					(unselect)="listSrv.unselectOne(product, true)"
					(update)="listSrv.update($event)">
				</product-grid-card-app>
			</ng-container>
		</div>
	</div>

	<ng-template #empty>
		<div class="empty flexCenter flexColumn">
			<icon-app name="product" fontSet="svg"></icon-app>
			<h2 i18n="header@@supplier-no-product">
				Currently this supplier has no products associated
			</h2>
			<h3 class="xl" i18n="header@@start-adding-products-now">
				You can start adding products now
			</h3>
			<button (click)="listSrv.create(true, {supplier: {id: supplierId}})"
				i18n="button@@add-product">
				Add Product
			</button>
		</div>
	</ng-template>

</card-app>

<product-preview-app
	*ngIf="listSrv.previewOpen"
	[product]="listSrv.previewed"
	(updated)="previewUpdated()"
	(close)="listSrv.closePreview()">
</product-preview-app>
