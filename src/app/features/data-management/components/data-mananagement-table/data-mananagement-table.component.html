<ng-template #contextualMenuTemplate let-row="row">
	<context-menu-item-app
		class="pointer flexCenter"
		(click)="delete.emit(row?.id)">
		Delete
	</context-menu-item-app>
</ng-template>

<table-app
	[rows]="rows"
	[pending]="pending"
  [selected]="selection"
  [contextualMenu]="contextualMenuTemplate"
  placeholder="No data"
	(selectOne)="select.emit($event)"
	(unselectOne)="unselect.emit($event)"
	(selectAll)="selectAll.emit($event)"
	(unselectAll)="unselectAll.emit()"
	(bottomReached)="bottomReached.emit()"
	(sort)="sort.emit($event)"
	(hovered)="onHover($event)">

	<!-- Name Category -->
	<ng-template *ngIf="ermEvent !== entityMetadata"
		columnApp="Name"
		let-row="row"
		width="250">
		<div class="flexBetween">
      <!-- <div> {{ row.name }} </div> -->
      <editable-text-app #editable (closed)="updateNameEntity(row, txtName?.value)" [hasAction]="true">
        <editable-label-app class="task-name">
          {{ row?.name }}
        </editable-label-app>
        <input inputApp class="task-name" #txtName [value]="row.name || ''">
      </editable-text-app>
			<!-- <button *ngIf="(row.id === idEntityHovered) && (selection.size == 0)"  class="button secondary-dark" (click)="renameEntity.emit(row)">Rename</button> -->
		</div>
	</ng-template>

	<!-- Name Event -->
	<ng-template *ngIf="ermEvent === entityMetadata"
		columnApp="Name"
		let-row="row"
		width="250"
		sortBy="description.name">
		<div class="flexBetween">
      <editable-text-app #editable (closed)="updateNameEntity(row, txtName?.value, 'description')" [hasAction]="true">
        <editable-label-app class="task-name">
          {{ row?.description?.name }}
        </editable-label-app>
        <input inputApp class="task-name" #txtName [value]="row?.description?.name || ''">
      </editable-text-app>
			<!-- <button *ngIf="(row.id === idEntityHovered) && (selection.size == 0)"  class="button secondary-dark" (click)="renameEntity.emit(row)">Rename</button> -->
		</div>
	</ng-template>

	<!-- Created By -->
	<ng-template *ngIf="ermEvent !== entityMetadata"
		columnApp="Created By"
		let-row="row"
		sortBy="createdBy.firstName"
		width="140">
		<span class="centered-text">
			{{ row?.createdBy ? row?.createdBy?.firstName : '' }} {{ row?.createdBy ? row?.createdBy?.lastName : '' }}
		</span>
	</ng-template>

	<!-- Products Count -->
	<ng-template *ngIf="ermCategory === entityMetadata || ermTag === entityMetadata"
		columnApp="Products Count"
		let-row="row"
		[sortable]="false"
		width="140">
		<span>
			{{ row?.productsLinked?.count }}
		</span>
	</ng-template>

	<!-- Supplier Count -->
	<ng-template *ngIf="ermCategory === entityMetadata || ermTag === entityMetadata"
		columnApp="Suppliers Count"
		let-row="row"
		[sortable]="false"
		width="140">
		<span>
			{{ row?.suppliersLinked?.count }}
		</span>
	</ng-template>

	<!-- Start Date (Event only) -->
	<ng-template *ngIf="ermEvent === entityMetadata"
		columnApp="Start Date"
		let-row="row"
		sortBy="description.startDate"
		width="140">
		<span>
			{{ row?.description?.startDate | date: 'MMMM d, y' }}
		</span>
	</ng-template>

	<!-- End Date (Event only) -->
	<ng-template *ngIf="ermEvent === entityMetadata"
		columnApp="End Date"
		let-row="row"
		sortBy="description.endDate"
		width="140">
		<span>
			{{ row?.description?.endDate | date: 'MMMM d, y' }}
		</span>
	</ng-template>

	<!-- No selection options -->
	<ng-template
		columnApp=""
		let-row="row"
		width="160">
		<div class="flex">
			<!-- If we are hovering over the row and we have nothing selection-->
			<button *ngIf="(row?.id === idEntityHovered) && (selection?.size == 0)" class="button secondary-dark" (click)="removeEntity.emit(row?.id)">Delete</button>
		</div>
	</ng-template>
</table-app>
