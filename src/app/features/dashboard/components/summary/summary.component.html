<card-app>
  <div class="top flexCenter flexColumn">

    <ng-container *ngIf="user">
			<user-picture-app [user]="user" size="68" [image]="user?.avatar" [border]="true"></user-picture-app>
      <h3 class="xs">{{ user?.firstName }} {{ user?.lastName }}</h3>
      <h4 class="ms">{{ user?.companyName }}</h4>
    </ng-container>

  </div>

  <divider-app></divider-app>

  <div class="secondBlock flexColumn" *ngIf="counters">

    <div class="flexVAlign">
      <span class="amount">{{ counters?.productsNeedReview }}</span>
      <div class="flexColumn">
        <span class="taskType">Product{{ counters?.productsNeedReview === 1 ? '' : 's' }} need{{ counters?.productsNeedReview === 1 ? 's' : '' }} review</span>
        <span><a [routerLink]="['/workspace']" routerLinkActive="active">Review Product{{ counters?.productsNeedReview > 1 ? 's' : '' }}</a></span>
      </div>
    </div>


    <div class="flexVAlign">
      <span class="amount">{{ counters?.productsInWorkflow }}</span>
      <div class="flexColumn">
        <span class="taskType">Product{{ counters?.productsInWorkflow === 1 ? '' : 's' }} in progress</span>
        <span>
          <a [routerLink]="['/workspace/my-workflow']" routerLinkActive="active">To my workspace</a>
        </span>
      </div>
    </div>

    <!-- <div class="flexVAlign">
      <span class="amount">{{ counters?.suppliersUnderAssessment }}</span>
      <div class="flexColumn desc">
        <span class="taskType">Supplier to assess</span>
        <span><a>To my workspace</a></span>
      </div>
    </div> -->

  </div>

	<divider-app></divider-app>

  <div class="taskTitle"> {{ counters?.tasksDone ? counters?.tasksDone + index : '0'}} / {{ counters?.totalTasks || '0' }} Tasks</div>

  <rating-cylinder-app [score]="taskScore"></rating-cylinder-app>

  <ng-container *ngFor="let task of tasks; trackBy: trackByFn; last as last">
		<div class="flexVAlign user-tasks pointer" [class.last]="last">
			<icon-app class="pointer" [ngClass]="{'color-success': task?.done, 'color-secondary': !task?.done}" [name]="task?.done ? 'check-round' : 'check-empty-round'" (click)="toggleDoneStatus(task)"></icon-app>
			<user-picture-app [size]="14" [user]="task.assignee" (click)="preview(task)"></user-picture-app>
			<div class="flexCenter" [ngStyle]="{'text-decoration': task?.done ? 'line-through' : 'none'}" (click)="preview(task)">{{ task?.name || 'Unnamed task' }}</div>
		</div>
  </ng-container>

  <card-footer-app paddingSide="l">
    <button (click)="goToWorkspace()">
      Open my workspace
    </button>
  </card-footer-app>

</card-app>

<task-preview-app
	*ngIf="previewOpen"
	[task]="toPreview"
	(close)="previewOpen = false;">
</task-preview-app>
