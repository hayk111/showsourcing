<card-app>
  <div class="top flexCenter flexColumn">

    <ng-container *ngIf="user">
			<user-picture-app [user]="user" size="68" [image]="user?.avatar" [border]="true"></user-picture-app>
      <h3 class="xs">{{ user?.firstName }} {{ user?.lastName }}</h3>
      <h4 class="ms">{{ user?.companyName }}</h4>
    </ng-container>

  </div>

  <divider-app></divider-app>

  <ng-container *ngIf="counters">
    <div class="secondBlock flexColumn">

      <div class="flexVAlign">
        <span class="amount">{{ counters?.productsNeedReview }}</span>
        <div class="flexColumn">
          <span class="taskType" i18n="text@@nested_product-need-review">
            { counters?.productsNeedReview ||0, plural, =0 { Product need } =1 { Product needs } other { Products need } }
            review
          </span>
          <span>
            <a [routerLink]="['/workspace']" routerLinkActive="active" i18n="link@@nested_review-product">
              Review {counters?.productsNeedReview || 0, plural, =0 { Product } =1 { Product } other { products } }
            </a>
          </span>
        </div>
      </div>


      <div class="flexVAlign">
        <span class="amount">{{ counters?.productsInWorkflow }}</span>
        <div class="flexColumn">
          <span class="taskType" i18n="text@@product-in-progress">
            { counters?.productsInWorkflow || 0, plural, =0 { Product } =1 { Product } other { Product } }
            in progress
          </span>
          <span>
            <a [routerLink]="['/workspace/my-workflow']" routerLinkActive="active" translate="link.to-my-workspace"></a>
          </span>
        </div>
      </div>

      <!-- <div class="flexVAlign">
        <span class="amount">{{ counters?.suppliersUnderAssessment }}</span>
        <div class="flexColumn desc">
          <span class="taskType">Supplier to assess</span>
          <span><a>To my workspace</a></span>
        </div>
      </div> -->

    </div>

    <divider-app></divider-app>

    <div class="taskTitle capitalize"> {{ counters?.tasksDone ? counters?.tasksDone + index : '0'}} / {{ counters?.totalTasks || '0' }} <ng-container translate="tasks"></ng-container></div>

    <rating-cylinder-app [score]="taskScore"></rating-cylinder-app>
  </ng-container>

  <ng-container *ngFor="let task of tasks; trackBy: trackByFn; last as last">
		<div class="flexVAlign user-tasks pointer" [class.last]="last">
			<icon-app class="pointer" [ngClass]="{'color-success': task?.done, 'color-secondary': !task?.done}" [name]="task?.done ? 'check-round' : 'check-empty-round'" (click)="toggleDoneStatus(task)"></icon-app>
			<user-picture-app [size]="14" [user]="task.assignee" (click)="preview(task)"></user-picture-app>
			<div class="flexCenter txt-btn" (click)="preview(task)">
        {{ task?.name || ('Unnamed task' | const: 'message') }}
      </div>
		</div>
  </ng-container>

  <card-footer-app paddingSide="l">
    <button (click)="goToWorkspace()" translate="button.open-workspace"></button>
  </card-footer-app>

</card-app>

<task-preview-app
	*ngIf="previewOpen"
	[task]="toPreview"
	(close)="previewOpen = false;">
</task-preview-app>
