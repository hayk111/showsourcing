<custom-table-app class="list"
  [rows]="rows"
  [descriptor]="descriptor"
  [contextualMenu]="contextualMenuTemplate"
  placeholder="No product"
  [selected]="selection"
  (bottomReached)="bottomReached.emit($event)"
  (sort)="sort.emit($event)"
  (selectOne)="select.emit($event)"
  (unselectOne)="unselect.emit($event)"
  (selectAll)="selectAll.emit($event)"
  (unselectAll)="unselectAll.emit()"
	[pending]="pending"
	i18n-placeholder="@@no-product">
</custom-table-app>

<!-- contextual menu -->
<ng-template #contextualMenuTemplate let-row="row">
  <context-menu-item-app class="pointer flexCenter" (click)="delete.emit(row.id)"
    i18n="button@@delete">
    Delete
  </context-menu-item-app>
  <context-menu-item-app *ngIf="row?.status?.status" class="pointer flexCenter" (click)="openRequestQuotationDialog.emit(row)"
    i18n="button@@request-information">
    Request information
  </context-menu-item-app>
</ng-template>

<!-- product preview -->
<ng-template #main let-row="row">
  <div class="mainCellWrapper ellipsis">
    <div class="mainCell">
      <img class="mini imgCtnr"
        [src]="row | image: 's' : 'product-list'" />
      <a class="name txt-btn" [routerLink]="['/', 'product', row.id]">{{ row.name }}</a>
    </div>
    <div class="preview">
      <button (click)="previewClick.emit(row)" class="small secondary-dark preview"
        i18n="button|to display a preview of an item@@preview">
        Preview
      </button>
    </div>
  </div>
</ng-template>

<!-- name -->
<ng-template #supplier let-row="row">
	{{ row?.supplier.name || '-' }}
</ng-template>

<!-- category -->
<ng-template #category let-row="row">
    {{ row?.category?.name || '-'}}
</ng-template>

<!-- price -->
<ng-template #price let-row="row">
	<price-app
		[price]="row?.price">
  </price-app>
</ng-template>

<!-- moq -->
<ng-template #moq let-row="row">
	<moq-app
		*ngIf="row?.price?.currency; else noMoq"
		[amount]="row?.minimumOrderQuantity">
  </moq-app>

  <ng-template #noMoq>
    <div>-</div>
  </ng-template>

</ng-template>

<!-- feedback -->
<ng-template #feedback let-row="row">
  {{ score(row) !== null ? score(row) : '-' }} %
</ng-template>

<!-- creation date -->
<ng-template #creationDate let-row="row">
  {{ row?.creationDate | date: 'dd MMMM y' }}
</ng-template>

<!-- favorite -->
<ng-template #favorite let-row="row">
  <div>
		<rating-heart-app
			[favorite]="row?.favorite"
			(favorited)="favorited.emit(row.id)"
			(unfavorited)="unfavorited.emit(row.id)">
		</rating-heart-app>
  </div>
</ng-template>

<!-- projects -->
<ng-template #projects let-row="row">
  <div class="flexCenter">
    <span *ngFor="let project of row.projects;trackBy: trackByFn">
      {{ project.name }}
    </span>
  </div>
</ng-template>

<!-- status -->
<ng-template #status let-row="row">
	<status-selector-app
		[entity]="row"
		[typeEntity]="prodErm">
  </status-selector-app>
</ng-template>

<!-- open btn -->
<ng-template #action let-row="row">
  <div class="pointer capitalize" (click)="open.emit(row.id)"
    i18n="button@@open"> open </div>
</ng-template>

<!-- for some mindblowing reason if this is put last,
	the viewchild for default template is undefined -->
<ng-template #default let-row="row" let-column="column">
  {{ row[column.propName] }}
</ng-template>

<!-- user -->
<ng-template #user let-row="row">
	<div class="flexCenter userP">
		{{ row?.createdBy | formatUserName }}
	</div>
<ng-template>

<!-- none -->
<ng-template #none></ng-template>
