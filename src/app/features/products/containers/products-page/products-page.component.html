
<entity-page-app
	[filterGroupName]="filterGroupName"
	[pending]="(productsState$ | async).pending"
	[repr]="repr"
	[subtitles]="['Products', 'all']"
  (filterClick)="openFilterPanel()"
  [view]="view"
	(viewChange)="onViewChange($event)">
		<!-- views: either one will be displayed when the correct view is selected -->
    <product-list-view-app
      *ngIf="view === 'list'"
      [class.hidden] = "view !== 'list'"
			class="list-view"
			[selection]="selection"
			[products]="products$ | async"
			(productSelect)="onItemSelected($event)"
			(productUnselect)="onItemUnselected($event)"
			(productOpen)="goToDetails($event)"
			(productFavorited)="onItemFavorited($event)"
			(productUnfavorited)="onItemUnfavorited($event)"
			(bottomReached)="loadMore()"></product-list-view-app>
		<product-card-view-app
      class="card-view"
      *ngIf="view === 'card'"
      [class.hidden] = "view !== 'card'"
			[products]="products$ | async"
			[selection]="selection"
			[statuses]="statuses$ | async"
			(update)="patch($event)"
			(productSelect)="onItemSelected($event)"
			(productDelete)="onItemDeleted($event)"
			(productUnselect)="onItemUnselected($event)"
			(productVote)="onItemVoted($event)"
			(addToProject)="onItemAddToProject($event)"
			(productFavorited)="onItemFavorited($event)"
			(productUnfavorited)="onItemUnfavorited($event)"
			(productOpen)="goToDetails($event)"></product-card-view-app>

</entity-page-app>

<selection-bar-app
	[repr]="repr"
	*ngIf="selection.size > 0"
	[selection]="selection"
  (close)="unselectAll()"
  (delete)="deleteSelected()">
  <selection-actions
  [selection]="selection"
  (openAddToProjectDialog)="openAddToProjectDialog()"
  (openExportDialog)="openExportDialog()"
  (openRequestFeedbackDialog)="openRequestFeedbackDialog()"
  ></selection-actions>
</selection-bar-app>

<ng-container *ngIf="filterPanelOpen$ | async">
	<filter-panel-app
		class="z-4"
		[filterGroupName]="filterGroupName"
		[filterClasses]="filterClasses"
		(clickOutside)="closeFilterPanel()">
	</filter-panel-app>
</ng-container>

<product-action-dialog-app
  [dialogName]="addProductDialog"
  header="Add to projects"
  title="My projects"
  buttonLabel="Add to projects"
  dialogType="add"
  [entities]="projects$ | async"
  [productsCount]="productsCount$ | async"
  (buttonClicked)="addToProjects($event)"
></product-action-dialog-app>

<product-action-dialog-app
  [dialogName]="requestFeedbackDialog"
  header="Request Team Feedback"
  title="Team members"
  buttonLabel="Send request"
  [entities]="teamMembers$ | async"
  dialogType="feedback"
  (buttonClicked)="requestFeeback($event)"
></product-action-dialog-app>

<product-action-dialog-app
  [dialogName]="exportDialog"
  header="Export Slection"
  title="Export type"
  buttonLabel="Export now"
  dialogType="export"
  (buttonClicked)="export($event)"
></product-action-dialog-app>

