

<ng-container *ngIf="items$ | async as products">
	<!-- top panel -->
	<top-panel-app
		[title]="entityMetadata.plural"
		[subtitles]="['Products', 'all']">
	</top-panel-app>

	<sub-panel-app
		[hasSwitch]="false"
		[hasFilter]="true"
		[buttonIcon]="false"
		buttonName="Add {{entityMetadata.singular}}"
		(buttonClick)="openCreateDlg(true)"
		(showFilters)="openFilterPanel()"
		(search)="search($event)">
	</sub-panel-app>

	<!-- views: either one will be displayed when the correct view is selected -->
	<product-list-view-app
		*ngIf="view === 'list'"
		class="list-view"
		[selection]="selected$ | async"
		[rows]="products"
		[pending]="pending"
		(previewClick)="openPreview($event)"
		(select)="onItemSelected($event)"
		(unselect)="onItemUnselected($event)"
		(selectAll)="selectAll($event)"
		(unselectAll)="resetSelection()"
		(open)="goToDetails($event)"
		(favorited)="onItemFavorited($event)"
		(unfavorited)="onItemUnfavorited($event)"
		(bottomReached)="loadMore()"
		(sort)="sort($event)"
		(openAddToProjectDialog)="openAddToProjectDialog($event)"
		(openExportDialog)="openExportDialog($event)"
		(openRequestFeedbackDialog)="openRequestFeedbackDialog($event)"
		(delete)="deleteSelected($event)"></product-list-view-app>

	<product-card-view-app
		class="card-view"
		*ngIf="view === 'card'"
		[rows]="products"
		[selection]="selected$ | async"
		(update)="update($event)"
		(select)="onItemSelected($event)"
		(unselect)="onItemUnselected($event)"
		(favorited)="onItemFavorited($event)"
		(unfavorited)="onItemUnfavorited($event)"
		(open)="goToDetails($event)"></product-card-view-app>

	<selection-bar-app
		*ngIf="(selected$ | async).size > 0"
		[selection]="selected$ | async"
		(close)="resetSelection()"
		(delete)="deleteSelected()">

		<selection-actions
			[selection]="selected$ | async"
			(openAddToProjectDialog)="openAddToProjectDialog()"
			(openExportDialog)="openExportDialog()"
			(openRequestFeedbackDialog)="openRequestFeedbackDialog()">
		</selection-actions>
	</selection-bar-app>

	<product-filters-app
		(clickOutside)="closeFilterPanel()"
		(filter)="filter($event)"
		*ngIf="filterPanelOpen">
	</product-filters-app>

	<product-preview-app
		[product]="previewed"
		(close)="closePreview()"
		(clickOutside)="closePreview()"
		*ngIf="previewOpen">

	</product-preview-app>

</ng-container>


